/*!

    IleoOverlay
    from @ileotechparis

*/
!function(){"use strict";angular.module("ileo.overlay",[]).constant("ILEO_OVERLAY_DEFAULT_PARAMS",{data:{},class:"",overlap:!0,hasBackdrop:!0,openOnStart:!1,hasAjaxAction:!1,template:"<p><button close-ileo-overlay>Close</button></p>"}).constant("ILEO_OVERLAY_CSS",{overlay:{top:"10%",left:"10%",zIndex:1e3,width:"80%",height:"80%",position:"fixed",background:"rgba(255,255,255,1)"},backdrop:{top:0,left:0,zIndex:999,width:"100%",height:"100%",position:"fixed",background:"rgba(0,0,0,.5)"}})}(),function(){"use strict";function e(e,r,t,o,n,a){var l=function(){var e=this;return e.currentOverlays={},document.onkeyup=e.keyPressed,n.$on("ileo:overlay:close",function(){e.closeOverlay()}),{open:function(r,t){return e.openOverlay(r||a,t)},close:function(r){return e.closeOverlay(r)},toggle:function(r,t){return e.currentOverlays[t]?this.close(t):this.open(r,t)}}};return l.prototype={keyPressed:function(e){e=e||window.event,27===e.keyCode&&n.$broadcast("ileo:overlay:close")},creaetId:function(){return Math.floor(Math.random()*(new Date).getTime()).toString().substr(0,12)},openOverlay:function(a,l){var c=this,i=e.defer(),l=l||c.creaetId();if(!Object.keys(c.currentOverlays).includes(l)||a.overlap===!0){c.currentOverlays[l]={};var s=a.scope||n.$new();r("<ileo-overlay></ileo-overlay>")(s,function(e,r){r.params=a,c.currentOverlays[l].$scope=r,c.currentOverlays[l].$element=e,c.currentOverlays[l].createdAt=(new Date).getTime(),o.find("body").append(c.currentOverlays[l].$element),t(i.resolve)})}return i.promise},getLastCreatedOverlay:function(){var e=this;return!(Object.keys(e.currentOverlays).length<=0)&&Object.keys(e.currentOverlays).reduce(function(r,t){return!r||e.currentOverlays[t].createdAt>e.currentOverlays[r].createdAt?t:r})},closeOverlay:function(r){var o=e.defer(),n=r||this.getLastCreatedOverlay();return n?(this.currentOverlays[n].$scope.params.scope||this.currentOverlays[n].$scope.$destroy(),this.currentOverlays[n].$element.empty().remove(),delete this.currentOverlays[n],t(o.resolve)):o.reject(),o.promise}},new l}var r=["$q","$compile","$timeout","$document","$rootScope","ILEO_OVERLAY_DEFAULT_PARAMS"];e.$inject=r,angular.module("ileo.overlay").service("ileoOverlayService",e)}(),function(){"use strict";function e(e){var r=function(){var r=this;r.overlayCss=e.overlay,r.backdropCss=e.backdrop};return r.prototype={setOverlayCss:function(e,r){this.overlayCss[e]=r},setBackdropCss:function(e,r){this.backdropCss[e]=r}},new r}var r=["ILEO_OVERLAY_CSS"];e.$inject=r,angular.module("ileo.overlay").service("ileoOverlayConfigService",e)}(),function(){"use strict";function e(e,r,t,o,n,a,l,c){function i(){"hasBackdrop"in f&&f.hasBackdrop,e.all({data:u(f),template:s(f)}).then(p).catch(v)}function s(t){var o=e.defer();return"template"in t?o.resolve(t.template):"templateUrl"in t?r({method:"GET",url:t.templateUrl}).then(function(e){o.resolve(e.data)},function(e){o.reject({error:"Unable to retrieve the template from templateUrl",ajaxTrace:e})}):o.reject({error:"You must specify a template or a templateUrl"}),o.promise}function u(t){var o=e.defer();return"dataUrl"in t?r({method:"GET",url:t.dataUrl}).then(function(e){o.resolve(e.data)},function(e){o.reject({error:"Unable to retrieve data from given action URL",ajaxTrace:e})}):o.resolve({}),o.promise}function v(e){console.error(e)}function p(e){y.data=e.data,d(e.template).then(function(){}).catch(function(e){v("The template is not compilable: "+e)})}function d(r){var n=e.defer();try{o(r)(t,function(e){m.append(e),a(n.resolve())})}catch(e){n.reject(e)}return n.promise}var y=this,f=t.$parent.params,m=angular.element(n[0].getElementsByClassName("ileoOverlay--wrapper"));a(i),y.close=l.close,console.info("cbp",t)}var r={transclude:!1,dependencies:["$q","$http","$scope","$compile","$element","$timeout","ileoOverlayService","ileoOverlayConfigService"],bindings:{},template:'<aside class="ileoOverlay"><div class="ileoOverlay--wrapper" ng-style="$ctrl.overlayStyle"></div><div class="ileoOverlay--backdrop" ng-click="$ctrl.close()" ng-style="$ctrl.backdropStyle"></div></aside>'};e.$inject=r.dependencies,angular.module("ileo.overlay").component("ileoOverlay",{bindings:r.bindings,template:r.template,controller:e})}(),function(){"use strict";function e(e){var r=function(r,t){t.on("click",function(){e.close()})};return{scope:!1,restrict:"A",link:r}}var r=["ileoOverlayService"];angular.module("ileo.overlay").directive("closeIleoOverlay",r.concat([e]))}(),function(){"use strict";function e(e){var r=function(r,t,o){t.on("click",function(){e.open(r.setup,o.toggleIleoOverlay)})};return{scope:{setup:"="},restrict:"A",link:r}}var r=["ileoOverlayService"];angular.module("ileo.overlay").directive("openIleoOverlay",r.concat([e]))}(),function(){"use strict";function e(e){var r=function(r,t,o){t.on("click",function(){e.toggle(r.setup,o.toggleIleoOverlay)})};return{scope:{setup:"="},restrict:"A",link:r}}var r=["ileoOverlayService"];angular.module("ileo.overlay").directive("toggleIleoOverlay",r.concat([e]))}();