/*!

    IleoOverlay
    from @ileotechparis

*/
!function(){"use strict";angular.module("ileo.overlay",[]).constant("ILEO_OVERLAY_DEFAULT_PARAMS",{data:{},class:"",overlap:!0,hasBackdrop:!0,openOnStart:!1,hasAjaxAction:!1,template:"<p><button close-ileo-overlay>Close</button></p>"}).constant("ILEO_OVERLAY_CSS",{overlay:{top:"10%",left:"10%",zIndex:1e3,width:"80%",height:"80%",position:"fixed",background:"rgba(255,255,255,1)"},backdrop:{top:0,left:0,zIndex:999,width:"100%",height:"100%",position:"fixed",background:"rgba(0,0,0,.5)"}})}(),function(){"use strict";function e(e,t,r,o,n,a){var l=function(){var e=this;return e.currentOverlays={},document.onkeyup=e.keyPressed,n.$on("ileo:overlay:escape",function(){e.closeOverlay()}),{open:function(t,r){return e.openOverlay(t||a,r)},close:function(t){return e.closeOverlay(t)},toggle:function(t,r){return e.currentOverlays[r]?this.close(r):this.open(t,r)}}};return l.prototype={keyPressed:function(e){e=e||window.event,27===e.keyCode&&n.$broadcast("ileo:overlay:escape")},creaetId:function(){return Math.floor(Math.random()*(new Date).getTime()).toString().substr(0,12)},openOverlay:function(a,l){var c=this,i=e.defer(),l=l||c.creaetId();if(!Object.keys(c.currentOverlays).includes(l)||a.overlap===!0){c.currentOverlays[l]={};var s=n.$new();t("<ileo-overlay></ileo-overlay>")(s,function(e,t){t.params=a,c.currentOverlays[l].$scope=t,c.currentOverlays[l].$element=e,c.currentOverlays[l].createdAt=(new Date).getTime(),o.find("body").append(c.currentOverlays[l].$element),r(function(){i.resolve(),n.$broadcast("ileo:overlay:open",l)})})}return i.promise},getLastCreatedOverlay:function(){var e=this;return!(Object.keys(e.currentOverlays).length<=0)&&Object.keys(e.currentOverlays).reduce(function(t,r){return!t||e.currentOverlays[r].createdAt>e.currentOverlays[t].createdAt?r:t})},closeOverlay:function(t){var o=e.defer(),a=t||this.getLastCreatedOverlay();return a?(this.currentOverlays[a].$scope.$destroy(),this.currentOverlays[a].$element.empty().remove(),delete this.currentOverlays[a],r(function(){o.resolve(),n.$broadcast("ileo:overlay:close",a)})):o.reject(),o.promise}},new l}var t=["$q","$compile","$timeout","$document","$rootScope","ILEO_OVERLAY_DEFAULT_PARAMS"];e.$inject=t,angular.module("ileo.overlay").service("ileoOverlayService",e)}(),function(){"use strict";function e(e){var t=function(){var t=this;t.overlayCss=e.overlay,t.backdropCss=e.backdrop};return t.prototype={setOverlayCss:function(e,t){this.overlayCss[e]=t},setBackdropCss:function(e,t){this.backdropCss[e]=t}},new t}var t=["ILEO_OVERLAY_CSS"];e.$inject=t,angular.module("ileo.overlay").service("ileoOverlayConfigService",e)}(),function(){"use strict";function e(e,t,r,o,n,a,l,c){function i(){"hasBackdrop"in f&&f.hasBackdrop,e.all({data:u(f),template:s(f)}).then(p).catch(v)}function s(r){var o=e.defer();return"template"in r?o.resolve(r.template):"templateUrl"in r?t({method:"GET",url:r.templateUrl}).then(function(e){o.resolve(e.data)},function(e){o.reject({error:"Unable to retrieve the template from templateUrl",ajaxTrace:e})}):o.reject({error:"You must specify a template or a templateUrl"}),o.promise}function u(r){var o=e.defer();return"dataUrl"in r?t({method:"GET",url:r.dataUrl}).then(function(e){o.resolve(e.data)},function(e){o.reject({error:"Unable to retrieve data from given action URL",ajaxTrace:e})}):o.resolve({}),o.promise}function v(e){console.error(e)}function p(e){y.data=e.data,y.local=f.scope||{},d(e.template).then(function(){}).catch(function(e){v("The template is not compilable: "+e)})}function d(t){var n=e.defer();try{o(t)(r,function(e){m.append(e),a(n.resolve())})}catch(e){n.reject(e)}return n.promise}var y=this,f=r.$parent.params,m=angular.element(n[0].getElementsByClassName("ileoOverlay--wrapper"));a(i),y.close=l.close}var t={transclude:!1,dependencies:["$q","$http","$scope","$compile","$element","$timeout","ileoOverlayService","ileoOverlayConfigService"],bindings:{},template:'<aside class="ileoOverlay"><div class="ileoOverlay--wrapper" ng-style="$ctrl.overlayStyle"></div><div class="ileoOverlay--backdrop" ng-click="$ctrl.close()" ng-style="$ctrl.backdropStyle"></div></aside>'};e.$inject=t.dependencies,angular.module("ileo.overlay").component("ileoOverlay",{bindings:t.bindings,template:t.template,controller:e})}(),function(){"use strict";function e(e){var t=function(t,r){r.on("click",function(){e.close()})};return{scope:!1,restrict:"A",link:t}}var t=["ileoOverlayService"];angular.module("ileo.overlay").directive("closeIleoOverlay",t.concat([e]))}(),function(){"use strict";function e(e){var t=function(t,r,o){r.on("click",function(){e.open(t.setup,o.toggleIleoOverlay)})};return{scope:{setup:"="},restrict:"A",link:t}}var t=["ileoOverlayService"];angular.module("ileo.overlay").directive("openIleoOverlay",t.concat([e]))}(),function(){"use strict";function e(e){var t=function(t,r,o){r.on("click",function(){e.toggle(t.setup,o.toggleIleoOverlay)})};return{scope:{setup:"="},restrict:"A",link:t}}var t=["ileoOverlayService"];angular.module("ileo.overlay").directive("toggleIleoOverlay",t.concat([e]))}();